<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>naowalkoptimiser: /Users/jason/Code/naowalkoptimiser/src/Network/GameController.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>/Users/jason/Code/naowalkoptimiser/src/Network/GameController.h</h1><a href="_game_controller_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// NUbots Game Controller</span>
<a name="l00002"></a>00002 
<a name="l00003"></a>00003 <span class="preprocessor">#ifndef GameController_H</span>
<a name="l00004"></a>00004 <span class="preprocessor"></span><span class="preprocessor">#define GameController_H</span>
<a name="l00005"></a>00005 <span class="preprocessor"></span><span class="preprocessor">#include &quot;../Globals.h&quot;</span>
<a name="l00006"></a>00006 <span class="preprocessor">#include &quot;<a class="code" href="_robo_cup_game_control_data_8h.html">RoboCupGameControlData.h</a>&quot;</span>
<a name="l00007"></a>00007 
<a name="l00008"></a>00008 
<a name="l00009"></a><a class="code" href="class_game_controller.html">00009</a> <span class="keyword">class </span><a class="code" href="class_game_controller.html">GameController</a>
<a name="l00010"></a>00010 {
<a name="l00011"></a>00011 
<a name="l00012"></a>00012     <span class="keyword">public</span>:
<a name="l00013"></a>00013 
<a name="l00014"></a><a class="code" href="class_game_controller.html#a38f17e349f91955d10c9d8511b245e9c">00014</a>         <span class="keyword">static</span> <a class="code" href="class_game_controller.html">GameController</a>&amp; <a class="code" href="class_game_controller.html#a38f17e349f91955d10c9d8511b245e9c">getInstance</a>()
<a name="l00015"></a>00015         {
<a name="l00016"></a>00016           <span class="keyword">static</span> <a class="code" href="class_game_controller.html">GameController</a> gameControllerInstance;
<a name="l00017"></a>00017           <span class="keywordflow">return</span> gameControllerInstance;
<a name="l00018"></a>00018         }
<a name="l00019"></a>00019 
<a name="l00020"></a>00020             <span class="keywordtype">void</span> <a class="code" href="class_game_controller.html#acbfb3093a04049bd7d70681c87e8d340">processPacket</a>(<a class="code" href="struct_robo_cup_game_control_data.html">RoboCupGameControlData</a> *packet); <span class="comment">// process the incoming gamecontrollere packet.</span>
<a name="l00021"></a>00021         <span class="keywordtype">bool</span> <a class="code" href="class_game_controller.html#a6152fab5a8515a3b145ea91ed087b153">checkForManualInput</a>();
<a name="l00022"></a>00022 
<a name="l00023"></a>00023         <span class="comment">// Access game info</span>
<a name="l00024"></a><a class="code" href="class_game_controller.html#ab0bafb83e5bed0cc9484f1a0b5c6cdae">00024</a>         <span class="keywordtype">int</span> <a class="code" href="class_game_controller.html#ab0bafb83e5bed0cc9484f1a0b5c6cdae">getTeamNumber</a>() { <span class="keywordflow">return</span> teamNumber; };
<a name="l00025"></a><a class="code" href="class_game_controller.html#a4a68a9b1b4781085b3a29f7ad703c63d">00025</a>         <span class="keywordtype">int</span> <a class="code" href="class_game_controller.html#a4a68a9b1b4781085b3a29f7ad703c63d">getPlayerNumber</a>() { <span class="keywordflow">return</span> playerNumber; };
<a name="l00026"></a>00026 
<a name="l00027"></a><a class="code" href="class_game_controller.html#a25bc6ce2ec570fc45628092fa01434a7">00027</a>         <span class="keywordtype">int</span> <a class="code" href="class_game_controller.html#a25bc6ce2ec570fc45628092fa01434a7">getGameState</a>() { <span class="keywordflow">return</span> controlData.<a class="code" href="struct_robo_cup_game_control_data.html#a0deb48e7303394812ac0dc33721aab9b">state</a>; };
<a name="l00028"></a><a class="code" href="class_game_controller.html#ab5b1f4b30a3ee84666ff741430311a64">00028</a>         <span class="keywordtype">int</span> <a class="code" href="class_game_controller.html#ab5b1f4b30a3ee84666ff741430311a64">getSecondaryState</a>() { <span class="keywordflow">return</span> controlData.<a class="code" href="struct_robo_cup_game_control_data.html#a1c5896e07af2834b426145bcabb4cbc5">secondaryState</a>; };
<a name="l00029"></a>00029 
<a name="l00030"></a><a class="code" href="class_game_controller.html#abefb82657dc1f395b3868eb41eac3fa9">00030</a>         <span class="keywordtype">int</span> <a class="code" href="class_game_controller.html#abefb82657dc1f395b3868eb41eac3fa9">getTeamColour</a>(){ <span class="keywordflow">return</span> myTeam-&gt;<a class="code" href="struct_team_info.html#a101430dde232645c1783f541aa847044">teamColour</a>; };
<a name="l00031"></a><a class="code" href="class_game_controller.html#a8bb875e5aa72659966274dd8276d284c">00031</a>         <span class="keywordtype">int</span> <a class="code" href="class_game_controller.html#a8bb875e5aa72659966274dd8276d284c">getKickoffTeam</a>() { <span class="keywordflow">return</span> controlData.<a class="code" href="struct_robo_cup_game_control_data.html#a4c6c347722e96a76341239e8f99722f5">kickOffTeam</a>; };
<a name="l00032"></a><a class="code" href="class_game_controller.html#ab24771de691b3942e195f08ca3099c07">00032</a>         <span class="keywordtype">bool</span> <a class="code" href="class_game_controller.html#ab24771de691b3942e195f08ca3099c07">isKickingOff</a>() { <span class="keywordflow">return</span> ( <a class="code" href="class_game_controller.html#a8bb875e5aa72659966274dd8276d284c">getKickoffTeam</a>() == <a class="code" href="class_game_controller.html#abefb82657dc1f395b3868eb41eac3fa9">getTeamColour</a>() );};
<a name="l00033"></a><a class="code" href="class_game_controller.html#a087f3cee9568c3c56a8e6f89cf5319b6">00033</a>         <span class="keywordtype">bool</span> <a class="code" href="class_game_controller.html#a087f3cee9568c3c56a8e6f89cf5319b6">isFirstHalf</a>() { <span class="keywordflow">return</span> (<span class="keywordtype">bool</span>)controlData.<a class="code" href="struct_robo_cup_game_control_data.html#aa234634e0023226ef905f089a6dc7cb3">firstHalf</a>; };
<a name="l00034"></a><a class="code" href="class_game_controller.html#abc733a241a79b8ed7d73d721bc0bf34f">00034</a>         <span class="keywordtype">bool</span> <a class="code" href="class_game_controller.html#abc733a241a79b8ed7d73d721bc0bf34f">isPenaltyShootout</a>() { <span class="keywordflow">return</span> (controlData.<a class="code" href="struct_robo_cup_game_control_data.html#a1c5896e07af2834b426145bcabb4cbc5">secondaryState</a> == <a class="code" href="_robo_cup_game_control_data_8h.html#ab229de95f021dbc155ca71e5f9967a5e">STATE2_PENALTYSHOOT</a>); };
<a name="l00035"></a><a class="code" href="class_game_controller.html#a68f31f431ed09e0c8bd025a1304ae8eb">00035</a>         <span class="keywordtype">int</span> <a class="code" href="class_game_controller.html#a68f31f431ed09e0c8bd025a1304ae8eb">getRemainingGameTime</a>() { <span class="keywordflow">return</span> controlData.<a class="code" href="struct_robo_cup_game_control_data.html#a325836c5775c153710ddf426130938b4">secsRemaining</a>; };
<a name="l00036"></a>00036 
<a name="l00037"></a><a class="code" href="class_game_controller.html#aa6b412af926bffac69d543fad05f25c5">00037</a>         <span class="keywordtype">int</span> <a class="code" href="class_game_controller.html#aa6b412af926bffac69d543fad05f25c5">getTimeSinceLastBallOut</a>() { <span class="keywordflow">return</span> controlData.<a class="code" href="struct_robo_cup_game_control_data.html#a38f1c1069be40cc99a55a6e14cbf9a38">dropInTime</a>; };
<a name="l00038"></a><a class="code" href="class_game_controller.html#addfa7e617c42033b9b1f7dbeb5774a65">00038</a>         <span class="keywordtype">int</span> <a class="code" href="class_game_controller.html#addfa7e617c42033b9b1f7dbeb5774a65">getLastBallOutTeam</a>() { <span class="keywordflow">return</span> controlData.<a class="code" href="struct_robo_cup_game_control_data.html#ae2d2605da8d8ee08ff9e4272dfcb71bd">dropInTeam</a>; };
<a name="l00039"></a><a class="code" href="class_game_controller.html#a559afbfe57194d427601952b42871ecf">00039</a>         <span class="keywordtype">bool</span> <a class="code" href="class_game_controller.html#a559afbfe57194d427601952b42871ecf">isPenalised</a>(){ <span class="keywordflow">return</span> <a class="code" href="class_game_controller.html#add4a04799e9084d91c46965b7d703546">isPlayerPenalised</a>(<a class="code" href="class_game_controller.html#a4a68a9b1b4781085b3a29f7ad703c63d">getPlayerNumber</a>(), <a class="code" href="class_game_controller.html#abefb82657dc1f395b3868eb41eac3fa9">getTeamColour</a>()); };
<a name="l00040"></a>00040         <span class="keywordtype">bool</span> <a class="code" href="class_game_controller.html#add4a04799e9084d91c46965b7d703546">isPlayerPenalised</a>(<span class="keywordtype">int</span> playerNumber, <span class="keywordtype">int</span> teamColour);
<a name="l00041"></a><a class="code" href="class_game_controller.html#aa1914f390e65ae1b6cc0a2dff2beb6a1">00041</a>         <span class="keywordtype">int</span> <a class="code" href="class_game_controller.html#aa1914f390e65ae1b6cc0a2dff2beb6a1">getRemainingPenaltyTime</a>(){ <span class="keywordflow">return</span> <a class="code" href="class_game_controller.html#ae54137d8d9e482c96221409ec0cac6c6">getPlayerPenaltyTimeRemaining</a>(<a class="code" href="class_game_controller.html#a4a68a9b1b4781085b3a29f7ad703c63d">getPlayerNumber</a>(), <a class="code" href="class_game_controller.html#abefb82657dc1f395b3868eb41eac3fa9">getTeamColour</a>());};
<a name="l00042"></a>00042         <span class="keywordtype">int</span> <a class="code" href="class_game_controller.html#ae54137d8d9e482c96221409ec0cac6c6">getPlayerPenaltyTimeRemaining</a>(<span class="keywordtype">int</span> player, <span class="keywordtype">int</span> teamColour);
<a name="l00043"></a>00043         <span class="keywordtype">int</span> <a class="code" href="class_game_controller.html#a01e5e28358633533fc82cff312fcda46">getTeamScore</a>(<span class="keywordtype">int</span> teamColour);
<a name="l00044"></a>00044         
<a name="l00045"></a><a class="code" href="class_game_controller.html#a710c9e68d68c997b7bfa6f3e850cba30">00045</a>         <span class="keywordtype">bool</span> <a class="code" href="class_game_controller.html#a710c9e68d68c997b7bfa6f3e850cba30">getReturnPacketToBeSent</a>() { <span class="keywordflow">return</span> returnPacketToBeSent; };
<a name="l00046"></a><a class="code" href="class_game_controller.html#ab2ee119ff3963097f76f03e308109f86">00046</a>         <a class="code" href="struct_robo_cup_game_control_return_data.html">RoboCupGameControlReturnData</a> <a class="code" href="class_game_controller.html#ab2ee119ff3963097f76f03e308109f86">getReturnPacket</a>() { returnPacketToBeSent = <span class="keyword">false</span>; <span class="keywordflow">return</span> returnPacket; };
<a name="l00047"></a>00047 
<a name="l00048"></a>00048         <a class="code" href="struct_robo_cup_game_control_data.html">RoboCupGameControlData</a> <a class="code" href="class_game_controller.html#a306b1a3e9d8caa274ee6fe625c93c8b9">getControlData</a>();
<a name="l00049"></a>00049     
<a name="l00050"></a>00050 
<a name="l00051"></a>00051     <span class="keyword">private</span>:
<a name="l00052"></a>00052 
<a name="l00053"></a>00053         <span class="comment">// Sensor Tracking Variables</span>
<a name="l00054"></a>00054             <span class="keywordtype">bool</span> leftFootLeftBumperPressed, leftFootRightBumperPressed, rightFootLeftBumperPressed, rightFootRightBumperPressed; <span class="comment">// Storage of foot bumper states</span>
<a name="l00055"></a>00055         <span class="keywordtype">bool</span> chestButtonPressed;
<a name="l00056"></a>00056         <span class="keywordtype">bool</span> chestHasTriggered;
<a name="l00057"></a>00057             <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> ChestButtonTriggerTime = 150; <span class="comment">// Button press threshold in milliseconds.</span>
<a name="l00058"></a>00058             <span class="keywordtype">long</span> <span class="keywordtype">long</span> chestButtonPressTime; <span class="comment">// Time Keeping for chest button</span>
<a name="l00059"></a>00059 
<a name="l00060"></a>00060         <span class="comment">// Game information</span>
<a name="l00061"></a>00061         <a class="code" href="struct_robo_cup_game_control_data.html">RoboCupGameControlData</a> controlData; <span class="comment">// Storage of the current game controller data.</span>
<a name="l00062"></a>00062             <span class="keywordtype">int</span> playerNumber; <span class="comment">// The robots player number.</span>
<a name="l00063"></a>00063             <span class="keywordtype">int</span> teamNumber; <span class="comment">// The robots team number.</span>
<a name="l00064"></a>00064             <a class="code" href="struct_team_info.html">TeamInfo</a>* myTeam; <span class="comment">// Pointer to the game data specific to the robots current team. </span>
<a name="l00065"></a>00065         <span class="keywordtype">int</span> previousState;
<a name="l00066"></a>00066         <a class="code" href="struct_robo_cup_game_control_return_data.html">RoboCupGameControlReturnData</a> returnPacket;
<a name="l00067"></a>00067         <span class="keywordtype">bool</span> returnPacketToBeSent;
<a name="l00068"></a>00068 
<a name="l00069"></a>00069         <span class="comment">// Init Functions</span>
<a name="l00070"></a>00070             <span class="keywordtype">void</span> initGameData();        <span class="comment">// Setup default values for gameData.</span>
<a name="l00071"></a>00071             <span class="keywordtype">void</span> loadTeamCfg(std::string filename = <span class="stringliteral">&quot;/home/root/player.cfg&quot;</span>);   <span class="comment">// Read in configuration data from file.</span>
<a name="l00072"></a>00072 
<a name="l00073"></a>00073         <span class="comment">// Sounds</span>
<a name="l00074"></a>00074         <span class="keywordtype">void</span> announceState(<span class="keywordtype">int</span> state);
<a name="l00075"></a>00075         <span class="keywordtype">void</span> announceTeamColour(<span class="keywordtype">int</span> teamColour);
<a name="l00076"></a>00076         <span class="keywordtype">void</span> announceKickoff(<span class="keywordtype">bool</span> kickingOff);
<a name="l00077"></a>00077         <span class="keywordtype">void</span> playUnfairPenaltySound();
<a name="l00078"></a>00078 
<a name="l00079"></a>00079         <span class="comment">// Others</span>
<a name="l00080"></a>00080             <span class="keywordtype">void</span> displayLEDs(); <span class="comment">// Set Leds to display the robots current game state.</span>
<a name="l00081"></a>00081             <span class="keywordtype">void</span> swapTeams();   <span class="comment">// Swaps the colours of the teams.</span>
<a name="l00082"></a>00082         <span class="keywordtype">void</span> rawSwapTeams(<a class="code" href="struct_robo_cup_game_control_data.html">RoboCupGameControlData</a>* data);
<a name="l00083"></a>00083             <span class="keywordtype">bool</span> validatePacket(<a class="code" href="struct_robo_cup_game_control_data.html">RoboCupGameControlData</a>* packet);        <span class="comment">// Checks that the gamecontroller packet is of the right version and for the correct game.</span>
<a name="l00084"></a>00084         <span class="keywordtype">bool</span> isThisGame(<a class="code" href="struct_robo_cup_game_control_data.html">RoboCupGameControlData</a>* data);
<a name="l00085"></a>00085         <span class="keywordtype">bool</span> dataEqual(<span class="keywordtype">void</span>* data, <span class="keywordtype">void</span>* prev);
<a name="l00086"></a>00086         <span class="keywordtype">bool</span> checkHeader(<span class="keywordtype">char</span>* header);
<a name="l00087"></a>00087             <span class="keywordtype">int</span> doManualStateChange();  <span class="comment">// Called when a state change has been manually triggered by the chest button.</span>
<a name="l00088"></a>00088             <span class="keywordtype">void</span> manualPenalise(<span class="keywordtype">bool</span> penalty);  <span class="comment">// Called when a penalty change is triggered by the chest button.</span>
<a name="l00089"></a>00089 
<a name="l00090"></a>00090     <span class="keyword">private</span>:
<a name="l00091"></a>00091         <span class="comment">// Hidden for static class</span>
<a name="l00092"></a>00092         <a class="code" href="class_game_controller.html">GameController</a>();                             <span class="comment">// Private constructor</span>
<a name="l00093"></a>00093         ~<a class="code" href="class_game_controller.html">GameController</a>();                             <span class="comment">// Private destructor</span>
<a name="l00094"></a>00094         <a class="code" href="class_game_controller.html">GameController</a>(<span class="keyword">const</span> <a class="code" href="class_game_controller.html">GameController</a>&amp;);            <span class="comment">// Prevent copy constructor</span>
<a name="l00095"></a>00095         <a class="code" href="class_game_controller.html">GameController</a>&amp; operator=(<span class="keyword">const</span> <a class="code" href="class_game_controller.html">GameController</a>&amp;); <span class="comment">// Prevent assignment</span>
<a name="l00096"></a>00096 
<a name="l00097"></a>00097 };
<a name="l00098"></a>00098 <span class="preprocessor">#endif // GameController_H</span>
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Fri Oct 9 13:42:11 2009 for naowalkoptimiser by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
